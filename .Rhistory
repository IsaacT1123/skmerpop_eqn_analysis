setwd("~/")
setwd("~/dev/ucsd")
q()
setwd("~/dev/ucsd/research/simulations")
setwd("C/Users/isaac/dev/ucsd/research/simulations")
setwd("C:/Users/isaac/dev/ucsd/research/simulations")
getwd()
setwd("C:/Users/isaac/dev/ucsd/research/simulations/skmerpop_eqn_analysis")
getwd()
t(replicate(3,simulation(d=0.01,rho=0.0)))
simulation <- function( L=100000,d=0.01, rho=0.05) {
p=1-(1-d)^31
G1=1:L
mut_pos = sample(G1,rpois(n = 1,lambda=L*p))
nonmut_pos = setdiff(G1,mut_pos)
mut_pos_new = sample(mut_pos, (1-rho)*length(mut_pos) )
mut_pos_silent = sample(nonmut_pos, length(setdiff(mut_pos, mut_pos_new)))
G2= c(nonmut_pos,mut_pos_new+10*L,mut_pos_silent)
ed = function(G1,G2) {
I = intersect(G1,G2);
U=union(G1,G2);
j=length(I)/length(U);
c(length(I),L*(1-p),1-(2*j/(1+j))^(1/31),d);}
ed(G1,G2)
}
simulation <- function( L=100000,d=0.01, rho=0.05) {
p=1-(1-d)^31
G1=1:L
mut_pos = sample(G1,rpois(n = 1,lambda=L*p))
nonmut_pos = setdiff(G1,mut_pos)
mut_pos_new = sample(mut_pos, (1-rho)*length(mut_pos) )
mut_pos_silent = sample(nonmut_pos, length(setdiff(mut_pos, mut_pos_new)))
G2= c(nonmut_pos,mut_pos_new+10*L,mut_pos_silent)
ed = function(G1,G2) {
I = intersect(G1,G2);
U=union(G1,G2);
j=length(I)/length(U);
c(length(I),L*(1-p),1-(2*j/(1+j))^(1/31),d);}
ed(G1,G2)
}
simulation <- function( L=100000,d=0.01, rho=0.05) {
p=1-(1-d)^31
G1=1:L
mut_pos = sample(G1,rpois(n = 1,lambda=L*p))
nonmut_pos = setdiff(G1,mut_pos)
mut_pos_new = sample(mut_pos, (1-rho)*length(mut_pos) )
mut_pos_silent = sample(nonmut_pos, length(setdiff(mut_pos, mut_pos_new)))
G2= c(nonmut_pos,mut_pos_new+10*L,mut_pos_silent)
ed = function(G1,G2) {
I = intersect(G1,G2);
U=union(G1,G2);
j=length(I)/length(U);
c(length(I),L*(1-p),1-(2*j/(1+j))^(1/31),d);}
ed(G1,G2)
}
simulation <- function( L=100000,d=0.01, rho=0.05) {
p=1-(1-d)^31
G1=1:L
mut_pos = sample(G1,rpois(n = 1,lambda=L*p))
nonmut_pos = setdiff(G1,mut_pos)
mut_pos_new = sample(mut_pos, (1-rho)*length(mut_pos) )
mut_pos_silent = sample(nonmut_pos, length(setdiff(mut_pos, mut_pos_new)))
G2= c(nonmut_pos,mut_pos_new+10*L,mut_pos_silent)
ed = function(G1,G2) {
I = intersect(G1,G2);
U=union(G1,G2);
j=length(I)/length(U);
c(length(I),L*(1-p),1-(2*j/(1+j))^(1/31),d);}
ed(G1,G2)
}
simulation <- function( L=100000,d=0.01, rho=0.05) {
p=1-(1-d)^31
G1=1:L
mut_pos = sample(G1,rpois(n = 1,lambda=L*p))
nonmut_pos = setdiff(G1,mut_pos)
mut_pos_new = sample(mut_pos, (1-rho)*length(mut_pos) )
mut_pos_silent = sample(nonmut_pos, length(setdiff(mut_pos, mut_pos_new)))
G2= c(nonmut_pos,mut_pos_new+10*L,mut_pos_silent)
ed = function(G1,G2) {
I = intersect(G1,G2);
U=union(G1,G2);
j=length(I)/length(U);
c(length(I),L*(1-p),1-(2*j/(1+j))^(1/31),d);}
ed(G1,G2)
}
simulation <- function( L=100000,d=0.01, rho=0.05) {
p=1-(1-d)^31
G1=1:L
mut_pos = sample(G1,rpois(n = 1,lambda=L*p))
nonmut_pos = setdiff(G1,mut_pos)
mut_pos_new = sample(mut_pos, (1-rho)*length(mut_pos) )
mut_pos_silent = sample(nonmut_pos, length(setdiff(mut_pos, mut_pos_new)))
G2= c(nonmut_pos,mut_pos_new+10*L,mut_pos_silent)
ed = function(G1,G2) {
I = intersect(G1,G2);
U=union(G1,G2);
j=length(I)/length(U);
c(length(I),L*(1-p),1-(2*j/(1+j))^(1/31),d);}
ed(G1,G2)
}
simulation <- function( L=100000,d=0.01, rho=0.05) {
p=1-(1-d)^31
G1=1:L
mut_pos = sample(G1,rpois(n = 1,lambda=L*p))
nonmut_pos = setdiff(G1,mut_pos)
mut_pos_new = sample(mut_pos, (1-rho)*length(mut_pos) )
mut_pos_silent = sample(nonmut_pos, length(setdiff(mut_pos, mut_pos_new)))
G2= c(nonmut_pos,mut_pos_new+10*L,mut_pos_silent)
ed = function(G1,G2) {
I = intersect(G1,G2);
U=union(G1,G2);
j=length(I)/length(U);
c(length(I),L*(1-p),1-(2*j/(1+j))^(1/31),d);}
ed(G1,G2)
}
simulation <- function( L=100000,d=0.01, rho=0.05) {
p=1-(1-d)^31
G1=1:L
mut_pos = sample(G1,rpois(n = 1,lambda=L*p))
nonmut_pos = setdiff(G1,mut_pos)
mut_pos_new = sample(mut_pos, (1-rho)*length(mut_pos) )
mut_pos_silent = sample(nonmut_pos, length(setdiff(mut_pos, mut_pos_new)))
G2= c(nonmut_pos,mut_pos_new+10*L,mut_pos_silent)
ed = function(G1,G2) {
I = intersect(G1,G2);
U=union(G1,G2);
j=length(I)/length(U);
c(length(I),L*(1-p),1-(2*j/(1+j))^(1/31),d);}
ed(G1,G2)
}
simulation <- function( L=100000,d=0.01, rho=0.05) {
p=1-(1-d)^31
G1=1:L
mut_pos = sample(G1,rpois(n = 1,lambda=L*p))
nonmut_pos = setdiff(G1,mut_pos)
mut_pos_new = sample(mut_pos, (1-rho)*length(mut_pos) )
mut_pos_silent = sample(nonmut_pos, length(setdiff(mut_pos, mut_pos_new)))
G2= c(nonmut_pos,mut_pos_new+10*L,mut_pos_silent)
ed = function(G1,G2) {
I = intersect(G1,G2);
U=union(G1,G2);
j=length(I)/length(U);
c(length(I),L*(1-p),1-(2*j/(1+j))^(1/31),d);}
ed(G1,G2)
}
clear
t(replicate(3,simulation(d=0.01,rho=0.0)))
t(replicate(3,simulation(d=0.01,rho=0.1)))
